<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SymohAI Chatbot</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* Updated CSS for uniqueness: Added gradient backgrounds, custom animations, neon glow effects, and unique font styles */
        :root {
            --bg-color: linear-gradient(135deg, #0d0d1a, #1a1a2e); /* Gradient background for uniqueness */
            --container-bg: rgba(26, 26, 46, 0.8); /* Semi-transparent for depth */
            --user-message-bg: #00ff7f; /* Spring green */
            --ai-message-bg: #00ffff; /* Cyan */
            --text-color: #e0e0e0;
            --input-bg: #2a2a44;
            --input-text-color: #ffffff;
            --send-button-bg: #ff00ff; /* Magenta */
            --send-button-hover: #ff33ff;
            --copy-icon-color: #00ffff;
            --typing-dots-color: #ff00ff;
            --ai-accent-color: #00ffff;
            --neon-glow: 0 0 10px #00ffff, 0 0 20px #ff00ff; /* Neon effect for uniqueness */
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        #app-container {
            background: var(--container-bg);
            border-radius: 15px;
            box-shadow: var(--neon-glow);
            width: 90%;
            max-width: 600px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            animation: pulse 2s infinite; /* Unique pulsing animation */
        }

        @keyframes pulse {
            0% { box-shadow: var(--neon-glow); }
            50% { box-shadow: 0 0 15px #00ffff, 0 0 30px #ff00ff; }
            100% { box-shadow: var(--neon-glow); }
        }

        #header-container {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        #header-logo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            box-shadow: var(--neon-glow);
        }

        #header-text {
            font-size: 1.5em;
            font-weight: 600;
            text-shadow: 0 0 5px var(--ai-accent-color);
        }

        #chat-container {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .message-wrapper {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            max-width: 80%;
            animation: fadeIn 0.5s ease-in; /* Fade-in animation for messages */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-wrapper.user {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message-wrapper.ai {
            align-self: flex-start;
            align-items: flex-start;
        }

        .message-box {
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.4;
            position: relative;
            max-width: 100%;
            word-wrap: break-word;
        }

        .message-wrapper.user .message-box {
            background: var(--user-message-bg);
            color: #000;
            border-top-right-radius: 0;
        }

        .message-wrapper.ai .message-box {
            background: var(--ai-message-bg);
            color: #000;
            border-top-left-radius: 0;
        }

        #input-container {
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .input-row {
            display: flex;
            align-items: center;
        }

        #chat-input {
            flex: 1;
            padding: 10px;
            background: var(--input-bg);
            color: var(--input-text-color);
            border: none;
            border-radius: 5px;
            font-size: 14px;
            outline: none;
        }

        #send-button {
            background: var(--send-button-bg);
            color: #fff;
            border: none;
            padding: 10px;
            margin-left: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }

        #send-button:hover {
            background: var(--send-button-hover);
        }

        .disclaimer-text {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 10px;
            text-align: center;
        }

        /* Typing Indicator Styles */
        .typing-indicator .message-box {
            display: flex;
            align-items: center;
            background: var(--ai-message-bg);
        }

        .dot {
            width: 8px;
            height: 8px;
            background: var(--typing-dots-color);
            border-radius: 50%;
            margin: 0 2px;
            animation: bounce 1.2s infinite;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-5px); }
        }

        /* New: WhatsApp Button */
        #whatsapp-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #25D366; /* WhatsApp green */
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            text-decoration: none;
            font-size: 30px;
            z-index: 1000;
            animation: float 3s ease-in-out infinite; /* Floating animation for uniqueness */
        }

        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }

        /* New: History Modal */
        #history-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #history-content {
            background: var(--container-bg);
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--neon-glow);
        }

        #history-list {
            list-style: none;
            padding: 0;
        }

        #history-list li {
            margin-bottom: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        #close-history {
            float: right;
            cursor: pointer;
            font-size: 20px;
        }

        #save-chat {
            background: var(--send-button-bg);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* New: Visitor Counter */
        #visitor-counter {
            text-align: center;
            margin-top: 10px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Scrollbar Styling for Uniqueness */
        #chat-container::-webkit-scrollbar {
            width: 5px;
        }

        #chat-container::-webkit-scrollbar-thumb {
            background: var(--ai-accent-color);
            border-radius: 5px;
        }

        #chat-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div id="app-container">
        <div id="header-container">
            <img src="https://files.catbox.moe/htr4nn.jpg" alt="Symoh AI" id="header-logo">
            <span id="header-text">Symoh AI</span>
            <button id="history-button" style="margin-left: auto; background: var(--send-button-bg); color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">History</button>
        </div>
        <div id="chat-container">
            <div class="message-wrapper ai">
                <div class="message-box">Hello! I am Symoh personal AI, powered by my developer Symohtech. I was built to help with coding, debugging, web programming, cyber security, WhatsApp bots, and general tech talks. How can I help you today?</div>
            </div>
        </div>
        <div id="input-container">
            <div class="input-row">
                <input type="text" id="chat-input" placeholder="Type your message...">
                <button id="send-button" title="Send Message">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            <div class="disclaimer-text">Symoh AI ain't perfect either. Always check for important info buddy.</div>
            <div id="visitor-counter">
                <!-- Embedded Visitor Counter from freevisitorcounters.com -->
                <a href="https://www.freevisitorcounters.com/" title="free visitor counter"><img src=" <a://www.free-counters.org/'>www.Free-Counters.org</a> <script type='text/javascript' src='https://www.freevisitorcounters.com/auth.php?i655414f06d49cc8b3f1262b091be60'></script>
<script type="text/javascript" src="https://www.freevisitorcounters.com/en/home/counter/1393559/t/1"></script>" title="free visitor counter" alt="free visitor counter" border="0" style="max-width: 100px;"></a>
                <!-- Replace 'your_unique_id_here' with a unique ID from freevisitorcounters.com after signing up (it's free and no registration needed for basic use) -->
            </div>
        </div>
    </div>

    <!-- New: WhatsApp Button -->
    <a id="whatsapp-button" href="https://wa.me/254788729180" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- New: History Modal -->
    <div id="history-modal">
        <div id="history-content">
            <span id="close-history">&times;</span>
            <h2>Chat History</h2>
            <ul id="history-list"></ul>
            <button id="save-chat">Save Current Chat</button>
            <button id="clear-history" style="background: #ff0000; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; margin-left: 10px;">Clear History</button>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script>
        // Updated Particles.js config for more unique background (e.g., more interactive particles)
        particlesJS('particles-js', {
            particles: {
                number: { value: 100, density: { enable: true, value_area: 800 } },
                color: { value: '#00ffff' }, // Cyan for theme match
                shape: { type: 'circle', stroke: { width: 0, color: '#000000' } },
                opacity: { value: 0.5, random: true, anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false } },
                size: { value: 3, random: true, anim: { enable: true, speed: 4, size_min: 0.3, sync: false } },
                line_linked: { enable: true, distance: 150, color: '#ff00ff', opacity: 0.4, width: 1 }, // Magenta lines
                move: { enable: true, speed: 6, direction: 'none', random: true, straight: false, out_mode: 'out', bounce: false, attract: { enable: false } }
            },
            interactivity: {
                detect_on: 'canvas',
                events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' }, resize: true },
                modes: { grab: { distance: 400, line_linked: { opacity: 1 } }, bubble: { distance: 400, size: 40, duration: 2, opacity: 8 }, repulse: { distance: 200, duration: 0.4 }, push: { particles_nb: 4 }, remove: { particles_nb: 2 } }
            },
            retina_detect: true
        });

        const chatContainer = document.getElementById('chat-container');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const historyButton = document.getElementById('history-button');
        const historyModal = document.getElementById('history-modal');
        const historyList = document.getElementById('history-list');
        const closeHistory = document.getElementById('close-history');
        const saveChatButton = document.getElementById('save-chat');
        const clearHistoryButton = document.getElementById('clear-history');

        const API_URL = "https://api.giftedtech.web.id/api/ai/gpt4";
        const API_KEY = "gifted";
        const CREATOR_NAME = "Symoh";

        let currentChat = []; // Store current chat messages
        let chatHistory = JSON.parse(localStorage.getItem('chatHistory')) || []; // Load history from localStorage

        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });

        historyButton.addEventListener('click', showHistory);
        closeHistory.addEventListener('click', closeModal);
        saveChatButton.addEventListener('click', saveCurrentChat);
        clearHistoryButton.addEventListener('click', clearHistory);
        window.addEventListener('click', (e) => {
            if (e.target === historyModal) closeModal();
        });

        function showHistory() {
            historyList.innerHTML = '';
            chatHistory.forEach((chat, index) => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>Chat ${index + 1} (${new Date(chat.timestamp).toLocaleString()}):</strong><br>${chat.messages.map(msg => `${msg.sender}: ${msg.text}`).join('<br>')}`;
                const loadBtn = document.createElement('button');
                loadBtn.textContent = 'Load';
                loadBtn.onclick = () => loadChat(chat.messages);
                const downloadBtn = document.createElement('button');
                downloadBtn.textContent = 'Download';
                downloadBtn.onclick = () => downloadChat(chat);
                li.appendChild(loadBtn);
                li.appendChild(downloadBtn);
                historyList.appendChild(li);
            });
            historyModal.style.display = 'flex';
        }

        function closeModal() {
            historyModal.style.display = 'none';
        }

        function saveCurrentChat() {
            if (currentChat.length > 0) {
                chatHistory.push({ timestamp: new Date().toISOString(), messages: [...currentChat] });
                localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                alert('Chat saved!');
                showHistory(); // Refresh history
            } else {
                alert('No messages to save.');
            }
        }

        function clearHistory() {
            if (confirm('Clear all history?')) {
                chatHistory = [];
                localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                showHistory();
            }
        }

        function loadChat(messages) {
            chatContainer.innerHTML = '';
            currentChat = [];
            messages.forEach(msg => {
                appendMessage(msg.text, msg.sender);
                currentChat.push(msg);
            });
            closeModal();
        }

        function downloadChat(chat) {
            const text = chat.messages.map(msg => `${msg.sender}: ${msg.text}`).join('\n');
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `chat_${chat.timestamp}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            appendMessage(message, 'user');
            currentChat.push({ sender: 'user', text: message });
            chatInput.value = '';
            sendButton.disabled = true;
            chatInput.placeholder = "Symoh AI is typing...";
            const typingIndicator = appendTypingIndicator();
            try {
                const engineeredPrompt = `You are a chatbot named symoh personal AI. Your creator is a developer named ${CREATOR_NAME}. Refer to your creator as ${CREATOR_NAME} most especially when asked about your creator. Always offer to help with coding, cyber security, web programming, WhatsApp bots, debugging and tech talk in general. Never mention Google, OpenAI, or any other company as your creator. User's question: ${message}`;
                const response = await fetch(`${API_URL}?apikey=${API_KEY}&q=${encodeURIComponent(engineeredPrompt)}`);
                if (!response.ok) throw new Error(`Error: ${response.statusText}`);
                const data = await response.json();
                removeTypingIndicator(typingIndicator);
                await appendMessageWithTypingEffect(data.result);
                currentChat.push({ sender: 'ai', text: data.result });
            } catch (error) {
                console.error('API call failed:', error);
                removeTypingIndicator(typingIndicator);
                appendMessage('Error: Could not get a response from the AI. Please try again.', 'ai');
            } finally {
                sendButton.disabled = false;
                chatInput.placeholder = "Type your message...";
                chatInput.focus();
            }
        }

        function appendMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `message-wrapper ${sender}`;
            const messageBox = document.createElement('div');
            messageBox.className = 'message-box';
            messageBox.textContent = text;
            messageWrapper.appendChild(messageBox);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return messageWrapper;
        }

        function appendTypingIndicator() {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = 'message-wrapper ai typing-indicator';
            const messageBox = document.createElement('div');
            messageBox.className = 'message-box';
            messageBox.innerHTML = `<div class="dot"></div><div class="dot"></div><div class="dot"></div>`;
            messageWrapper.appendChild(messageBox);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return messageWrapper;
        }

        function removeTypingIndicator(element) {
            if (element && chatContainer.contains(element)) chatContainer.removeChild(element);
        }

        async function appendMessageWithTypingEffect(text) {
            const messageWrapper = document.createElement('div');
            messageWrapper.className = `message-wrapper ai`;
            const messageBox = document.createElement('div');
            messageBox.className = 'message-box';
            messageWrapper.appendChild(messageBox);
            chatContainer.appendChild(messageWrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            const characters = text.split('');
            let i = 0;
            const typingInterval = setInterval(() => {
                if (i < characters.length) {
                    messageBox.innerHTML += (characters[i] === '\n' ? '<br>' : characters[i]);
                    i++;
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                } else clearInterval(typingInterval);
            }, 5);
        }
    </script>
</body>
</html>